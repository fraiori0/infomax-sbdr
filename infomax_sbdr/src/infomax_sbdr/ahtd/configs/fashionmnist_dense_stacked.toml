[model]
name = "dense_stacked_fashionmnist"
architecture = "dense_stack"

[hyperparams]
gamma_f = 0.9
gamma_l = 0.8
p_target = 0.1
momentum = 0.95
lr = 0.1

# Layer 1: 784 -> 256 features
[[layers]]
kernel_size = [1, 1]
in_channels = 784
out_channels = 256
init_scale_f = 1.0

# Layer 2: 256 -> 128 features
[[layers]]
kernel_size = [1, 1]
in_channels = 256
out_channels = 128
init_scale_f = 1.0

# Layer 3: 128 -> 64 features
[[layers]]
kernel_size = [1, 1]
in_channels = 128
out_channels = 64
init_scale_f = 1.0

[training]
n_epochs = 50
batch_size = 128
shuffle = true
seed = 42
skip_first = 5
checkpoint_interval = 5
eval_interval = 50

[validation]
split = 0.2
batch_size = 128

[dataset]
name = "fashion_mnist"
data_dir = "./data/fashion_mnist"
n_timesteps = 30
dt = 1.0
max_rate = 100.0

[logging]
log_dir = "./logs"
log_interval = 10
save_activations = true
